<form [formGroup]="form" class="ui-fluid" (ngSubmit)="submitForm()">

  <div class="my2">
    <span class="p-float-label">
      <input class="wide" formControlName="name" id="name" type="text" pInputText>
      <label for="name">Name</label>
      <small class="p-error block" *ngIf="isInvalid('name')">Name is required field</small>
    </span>
  </div>

  <div class="my2">
    <span class="p-float-label">
      <textarea class="wide" formControlName="description" id="description" rows="5" cols="30" pInputTextarea
                [autoResize]="true"></textarea>
      <label for="description">Description</label>
      <small class="p-error block" *ngIf="isInvalid('description')">Description is required field</small>
    </span>
  </div>

  <div>
    <h3>Ingredients (in 100g / 100ml)</h3>

    <ng-container formArrayName="ingredients" *ngFor="let ingredient of ingredients.controls; let i = index">
      <suple-ingredient-form-control [formControlName]="i" [mode]="mode.READONLY"
                                     (onDeleteEvent)="handleIngredientDelete(i)">
      </suple-ingredient-form-control>
    </ng-container>

    <suple-ingredient-form-control [mode]="mode.NEW"
                                   (onAddEvent)="addIngredient($event)"></suple-ingredient-form-control>

    <div class="summary right mt2" [ngClass]="{'p-error': ingredientsSum > 100}" *ngIf="ingredientsSum">
      Total: <strong>{{ingredientsSum}} </strong> (in 100g / 100ml)
    </div>
    <!-- TODO: add form error component -->
    <span *ngIf="ingredients.errors?.['error']">{{ingredients.errors?.['error']}}</span>
  </div>
  <div class="my2">
    <p-button type="submit" label="Submit" [disabled]="form.invalid"></p-button>
  </div>
</form>

<pre>
  valid: {{form.valid}}
  errors: {{form.errors|json}}
  value: {{form.value|json}}
</pre>
